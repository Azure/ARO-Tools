ResourceGroups:
- AKSCluster: ""
  Name: hcp-underlay-uks
  Steps:
  - AKSCluster: aro-hcp-aks
    Action: Shell
    Command: make deploy
    DependsOn: null
    DryRun:
      Command: ""
      Variables: null
    Name: deploy
    References: null
    ShellIdentity:
      ConfigRef: ""
      Input: null
      Name: ""
      Value: null
    SubnetId: ""
    Variables:
    - ConfigRef: maestro_image
      Input: null
      Name: MAESTRO_IMAGE
      Value: null
  - AKSCluster: ""
    Action: Shell
    Command: make deploy
    DependsOn: null
    DryRun:
      Command: ""
      Variables:
      - ConfigRef: ""
        Input: null
        Name: DRY_RUN
        Value: A very dry one
    Name: dry-run
    References: null
    ShellIdentity:
      ConfigRef: ""
      Input: null
      Name: ""
      Value: null
    SubnetId: ""
    Variables: null
  - Action: ARM
    Command: ""
    DependsOn: null
    DeploymentLevel: ResourceGroup
    DeploymentMode: ""
    Name: svc
    OutputOnly: false
    Parameters: test.bicepparam
    Template: templates/svc-cluster.bicep
    Variables: null
  - Action: DelegateChildZone
    Child:
      ConfigRef: childZone
      Input: null
      Name: childZone
      Value: null
    DependsOn:
    - deploy
    Name: cxChildZone
    Parent:
      ConfigRef: parentZone
      Input: null
      Name: parentZone
      Value: null
  - Action: SetCertificateIssuer
    Body:
      issuer:
        configRef: provider
        name: issuer
      vaultBaseUrl:
        configRef: vaultBaseUrl
        name: vaultBaseUrl
    DependsOn:
    - deploy
    Name: issuerTest
  - Action: SetCertificateIssuer
    Body:
      issuer:
        name: issuer
        value: provider
      vaultBaseUrl:
        input:
          name: kvUrl
          step: deploy
        name: vaultBaseUrl
    DependsOn:
    - deploy
    Name: issuerTestOutputChaining
  - Action: CreateCertificate
    Body:
      certificateName:
        name: certificateName
        value: hcp-mdsd
      contentType:
        name: contentType
        value: x-pem-file
      issuer:
        name: issuer
        value: OneCertV2-PrivateCA
      san:
        name: san
        value: hcp-mdsd.geneva.keyvault.aro-int.azure.com
      vaultBaseUrl:
        name: vaultBaseUrl
        value: https://arohcp-svc-ln.vault.azure.net
    DependsOn: null
    Name: cert
  - Action: ResourceProviderRegistration
    DependsOn: null
    Name: rpRegistration
    Namespaces:
      ConfigRef: ""
      Input: null
      Name: resourceProviderNamespaces
      Value:
      - Microsoft.Storage
      - Microsoft.EventHub
      - Microsoft.Insights
  - Action: RPLogsAccount
    Body:
      certdescription:
        name: certdescription
        value: HCP Service Cluster
      certsan:
        name: certsan
        value: san
      configVersion:
        name: configVersion
        value: version
      events:
        akskubesystem: kubesystem
      namespace:
        name: namespace
        value: ns
      subscriptionId:
        name: subscriptionId
        value: sub
    DependsOn: null
    Name: rpAccount
  - Action: ClusterLogsAccount
    Body:
      certdescription:
        name: certdescription
        value: HCP Management Cluster
      certsan:
        name: certsan
        value: san
      configVersion:
        name: configVersion
        value: version
      events:
        akskubesystem: kubesystem
      namespace:
        name: namespace
        value: ns
      subscriptionId:
        name: subscriptionId
        value: sub
    DependsOn: null
    Name: clusterAccount
  Subscription: hcp-uksouth
RolloutName: Test Rollout
ServiceGroup: Microsoft.Azure.ARO.Test
